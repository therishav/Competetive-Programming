#include<bits/stdc++.h>
using namespace std;

int main() {
  int t, n, m, k, ans=0;


  cin >> t;
  while(t--) {
    cin >> n >> m;
    vector<vector<int>> sticker_req;
    vector<int> collected_stickers(m+1);
    for(int i = 0; i < n; i++) {
      cin >> k;
      k++;
      while(k--) {
	int val;
	cin >> val;
	sticker_req[i].push_back(val);
      }
    }
    
    for(int i = 1; i <= m; i++) {
      int val;
      cin >> val;
      collected_stickers.push_back(val);
    }

    for(int i = 0; i < n; i++) {
      for(int j = 0; j < k; k++) {
	bool flag = flag;
	int index = sticker_req[i][j];
	if (!collected_stickers[index]) {
	  flag = true;
	  collected_stickers[index]--;
	}
	else {
	  break;
	}
	ans += sticker_req[i][k];
      }
    }
  }
  
  return 0;
}
